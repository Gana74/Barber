# Barber Telegram Bot

–õ—ë–≥–∫–∏–π Telegram‚Äë–±–æ—Ç –¥–ª—è –ø—Ä–∏—ë–º–∞ –∑–∞–ø–∏—Å–µ–π –Ω–∞ —É—Å–ª—É–≥–∏ –∫ –ü–∞—Ä–∏–∫–º–∞—Ö–µ—Ä—É —Å —Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –¥–∞–Ω–Ω—ã—Ö –≤ Google Sheets, —É—á—ë—Ç–æ–º —Ç–∞–π–º–∑–æ–Ω—ã —Å–∞–ª–æ–Ω–∞ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è–º–∏.

–ü—Ä–æ–µ–∫—Ç –Ω–∞–ø–∏—Å–∞–Ω –Ω–∞ Node.js —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `telegraf` –¥–ª—è –±–æ—Ç–∞ –∏ Google Sheets API –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –∏ –∑–∞–ø–∏—Å–µ–π.

**–ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏**

- –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è —Å—Ü–µ–Ω–∞ –∑–∞–ø–∏—Å–∏ (—É—Å–ª—É–≥–∞ ‚Üí –¥–∞—Ç–∞ ‚Üí –≤—Ä–µ–º—è ‚Üí –∫–æ–Ω—Ç–∞–∫—Ç ‚Üí –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ).
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—Å–ª—É–≥–∞–º–∏**: –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, —É–¥–∞–ª–µ–Ω–∏–µ —É—Å–ª—É–≥ —Å —Ü–µ–Ω–∞–º–∏ –∏ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é (—á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–º–µ–Ω—é).
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–ª–æ—Ç–∞–º–∏: —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –∏–∑ –ª–∏—Å—Ç–∞ `Schedule` –∏ —É–∂–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∏.
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ª–∏—Å—Ç–æ–≤ –∏ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –≤ Google Sheets –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ.
- –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è: –∑–∞ –¥–µ–Ω—å –∑–∞–ø–∏—Å–∏ (10:00 –ø–æ —Ç–∞–π–º–∑–æ–Ω–µ —Å–∞–ª–æ–Ω–∞), –∑–∞ 2 —á–∞—Å–∞ –¥–æ –∑–∞–ø–∏—Å–∏ –∏ –∫–ª–∏–µ–Ω—Ç–∞–º, –Ω–µ –ø–æ—Å–µ—â–∞–≤—à–∏–º —Å–∞–ª–æ–Ω –±–æ–ª–µ–µ 21 –¥–Ω—è.
- –•—Ä–∞–Ω–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –≤ –ª–∏—Å—Ç–µ `Clients`.
- –ú–µ–Ω–µ–¥–∂–µ—Ä—Å–∫–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, —á–µ—Ä–µ–∑ `MANAGER_CHAT_ID`).

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è**

- Node.js 18+ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è).
- –ê–∫–∫–∞—É–Ω—Ç —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞ Google —Å –¥–æ—Å—Ç—É–ø–æ–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫ —Ç–∞–±–ª–∏—Ü–µ.

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

1. –°–∫–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –∫–∞—Ç–∞–ª–æ–≥ –ø—Ä–æ–µ–∫—Ç–∞.
2. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ —Å–æ —Å–ª–µ–¥—É—é—â–∏–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏:

```
BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_–±–æ—Ç–∞
GOOGLE_SHEETS_ID=ID_–≤–∞—à–µ–π_—Ç–∞–±–ª–∏—Ü—ã
GOOGLE_CLIENT_EMAIL=service-account@project.iam.gserviceaccount.com
GOOGLE_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----\n"
DEFAULT_TIMEZONE=Asia/Yekaterinburg   # –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
MANAGER_CHAT_ID=123456789            # –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, id —á–∞—Ç–∞ –º–µ–Ω–µ–¥–∂–µ—Ä–∞
```

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –ø–æ–ª–µ `GOOGLE_PRIVATE_KEY` –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞. –í `.env` —Å–∏–º–≤–æ–ª—ã –ø–µ—Ä–µ–≤–æ–¥–∞ —Å—Ç—Ä–æ–∫–∏ –æ–±—ã—á–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –∫–∞–∫ `\n` ‚Äî –∫–æ–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–º–µ–Ω–∏—Ç –∏—Ö –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏.

3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–µ—Ä–≤–∏—Å–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç (–µ–≥–æ `client_email`) –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∞ Editor –Ω–∞–¥ Google Sheet (—á–µ—Ä–µ–∑ ¬´Share¬ª –≤ Google Sheets).

4. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç:

```powershell
npm install
npm start
```

–ù–∞ Windows `npm run dev` (–µ—Å–ª–∏ –µ—Å—Ç—å) –º–æ–∂–µ—Ç —Ç—Ä–µ–±–æ–≤–∞—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫–∏ `cross-env` –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å—Ä–µ–¥—ã; –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ –≤ PowerShell –º–æ–∂–Ω–æ –≤—Ä–µ–º–µ–Ω–Ω–æ –≤—ã—Å—Ç–∞–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é:

```powershell
$env:NODE_ENV = "development"
node index.js
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –≤–∞–∂–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

- `BOT_TOKEN` ‚Äî —Ç–æ–∫–µ–Ω –≤–∞—à–µ–≥–æ Telegram‚Äë–±–æ—Ç–∞.
- `GOOGLE_SHEETS_ID` ‚Äî ID Google Sheets —Ç–∞–±–ª–∏—Ü—ã, –≥–¥–µ –±—É–¥—É—Ç —Ö—Ä–∞–Ω–∏—Ç—å—Å—è –¥–∞–Ω–Ω—ã–µ.
- `GOOGLE_CLIENT_EMAIL` ‚Äî email —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞.
- `GOOGLE_PRIVATE_KEY` ‚Äî –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞ (–≤—Å—Ç–∞–≤–ª—è–π—Ç–µ –∫–∞–∫ –æ–¥–Ω—É —Å—Ç—Ä–æ–∫—É —Å `\n`).
- `DEFAULT_TIMEZONE` ‚Äî —Ç–∞–π–º–∑–æ–Ω–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –µ—Å–ª–∏ –≤ –ª–∏—Å—Ç–µ `Settings` –Ω–µ—Ç `timezone`).
- `MANAGER_CHAT_ID` ‚Äî (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) Telegram chat id –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π.

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Google Calendar (–Ω–æ–≤–∞—è)

–í –ø—Ä–æ–µ–∫—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∞ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∑–∞–ø–∏—Å–µ–π —Å Google Calendar.

- –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è: `GOOGLE_CALENDAR_ID` ‚Äî ID –∫–∞–ª–µ–Ω–¥–∞—Ä—è, –Ω–∞–ø—Ä–∏–º–µ—Ä `your-calendar-id@group.calendar.google.com` –∏–ª–∏ –≤–∞—à gmail-–∞–¥—Ä–µ—Å –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –ª–∏—á–Ω–æ–≥–æ –∫–∞–ª–µ–Ω–¥–∞—Ä—è.
- –°–µ—Ä–≤–∏—Å–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç: –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `GOOGLE_CLIENT_EMAIL` –∏ `GOOGLE_PRIVATE_KEY` (—É–∂–µ —Ç—Ä–µ–±—É—é—Ç—Å—è –¥–ª—è Google Sheets). –ï—Å–ª–∏ —ç—Ç–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞–¥–∞–Ω—ã, –±–æ—Ç –ø–æ–ø—ã—Ç–∞–µ—Ç—Å—è —Å–æ–∑–¥–∞—Ç—å/—É–¥–∞–ª—è—Ç—å —Å–æ–±—ã—Ç–∏—è –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ.

–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∏ —à–∞–≥–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

1. –í–∫–ª—é—á–∏—Ç–µ Google Calendar API –≤ –ø—Ä–æ–µ–∫—Ç–µ Google Cloud Console (APIs & Services ‚Üí Enable APIs and Services ‚Üí Google Calendar API).
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ `.env` —É–∫–∞–∑–∞–Ω—ã:

```
GOOGLE_CLIENT_EMAIL=barber-bot@your-project.iam.gserviceaccount.com
GOOGLE_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----\n"
GOOGLE_CALENDAR_ID=your-calendar-id@group.calendar.google.com
```

3. –î–∞–π—Ç–µ –¥–æ—Å—Ç—É–ø —Å–µ—Ä–≤–∏—Å–Ω–æ–º—É –∞–∫–∫–∞—É–Ω—Ç—É –∫ –∫–∞–ª–µ–Ω–¥–∞—Ä—é: –æ—Ç–∫—Ä–æ–π—Ç–µ Google Calendar –ø–æ–¥ –∞–∫–∫–∞—É–Ω—Ç–æ–º –≤–ª–∞–¥–µ–ª—å—Ü–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—è (—Ç–æ—Ç, —á–µ–π `GOOGLE_CALENDAR_ID` –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ), –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ "–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –¥–æ—Å—Ç—É–ø" –Ω—É–∂–Ω–æ–≥–æ –∫–∞–ª–µ–Ω–¥–∞—Ä—è ‚Üí "–î–æ—Å—Ç—É–ø –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º –ª—é–¥—è–º" ‚Üí "–î–æ–±–∞–≤–∏—Ç—å –ª—é–¥–µ–π" –∏ –≤—Å—Ç–∞–≤—å—Ç–µ `GOOGLE_CLIENT_EMAIL` (–Ω–∞–ø—Ä–∏–º–µ—Ä `barber-bot@...iam.gserviceaccount.com`) —Å –ø—Ä–∞–≤–æ–º `Make changes to events`.

4. –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –ª–∏—á–Ω—ã–π Gmail-–∫–∞–ª–µ–Ω–¥–∞—Ä—å (`@gmail.com`), —à–∞—Ä–∏–Ω–≥ —Å —Å–µ—Ä–≤–∏—Å–Ω—ã–º –∞–∫–∫–∞—É–Ω—Ç–æ–º —Ç–∞–∫–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚Äî —Å–µ—Ä–≤–∏—Å–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –±—É–¥–µ—Ç –∏–º–µ—Ç—å –¥–æ—Å—Ç—É–ø –∏–∑–º–µ–Ω—è—Ç—å —Å–æ–±—ã—Ç–∏—è.

–ï—Å–ª–∏ –∫–∞–ª–µ–Ω–¥–∞—Ä—å –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω –∏–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–µ –∑–∞–¥–∞–Ω—ã ‚Äî –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è (–Ω–µ —Ñ–∞—Ç–∞–ª—å–Ω–∞—è –æ—à–∏–±–∫–∞), –±–æ—Ç –ø—Ä–æ–¥–æ–ª–∂–∏—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å Google Sheets –∫–∞–∫ —Ä–∞–Ω—å—à–µ.

–¢–∞–∫–∂–µ –≤ `src/config/index.js` –µ—Å—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–∞–±–æ—á–∏—Ö —á–∞—Å–æ–≤ `workday` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é startHour:10, endHour:20). –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –º–æ–∂–Ω–æ –ø–æ–º–µ–Ω—è—Ç—å –∫–æ–¥ –∏–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Google Sheets

–ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –±–æ—Ç –≤—ã–∑—ã–≤–∞–µ—Ç `ensureSheetsStructure()` –∏ —Å–æ–∑–¥–∞—ë—Ç (–ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏) —Å–ª–µ–¥—É—é—â–∏–µ –ª–∏—Å—Ç—ã —Å–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏:

- `–ù–∞—Å—Ç—Ä–æ–π–∫–∏` ‚Äî –∫–ª—é—á/–∑–Ω–∞—á–µ–Ω–∏–µ (—Å—Ç–æ–ª–±—Ü—ã: `–∫–ª—é—á`, `–∑–Ω–∞—á–µ–Ω–∏–µ`). –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è `—á–∞—Å–æ–≤–æ–≥–æ_–ø–æ—è—Å–∞`.
- `–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ` ‚Äî —Å—Ç–æ–ª–±—Ü—ã: `–¥–∞—Ç–∞`, `–≤—Ä–µ–º—è_–Ω–∞—á–∞–ª–∞`, `–≤—Ä–µ–º—è_–æ–∫–æ–Ω—á–∞–Ω–∏—è`, `—Å—Ç–∞—Ç—É—Å`, `—É—Å–ª—É–≥–∞`, `–ø—Ä–∏–º–µ—á–∞–Ω–∏–µ`. –î–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `—Å—Ç–∞—Ç—É—Å=blocked`.
- `–ó–∞–ø–∏—Å–∏` ‚Äî —Å—Ç–æ–ª–±—Ü—ã: `id`, `—Å–æ–∑–¥–∞–Ω–æ_–≤_utc`, `—É—Å–ª—É–≥–∞`, `–¥–∞—Ç–∞`, `–≤—Ä–µ–º—è_–Ω–∞—á–∞–ª–∞`, `–≤—Ä–µ–º—è_–æ–∫–æ–Ω—á–∞–Ω–∏—è`, `–∏–º—è_–∫–ª–∏–µ–Ω—Ç–∞`, `—Ç–µ–ª–µ—Ñ–æ–Ω`, `–∏–º—è_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è`, `–∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π`, `—Å—Ç–∞—Ç—É—Å`, `–∫–æ–¥_–æ—Ç–º–µ–Ω—ã`, `telegram_id`, `id_—á–∞—Ç–∞`, `–∏—Å–ø–æ–ª–Ω–µ–Ω–æ_utc`, `–æ—Ç–º–µ–Ω–µ–Ω–æ_utc` .
- `–ö–ª–∏–µ–Ω—Ç—ã` ‚Äî —Å—Ç–æ–ª–±—Ü—ã: `id_–∫–ª–∏–µ–Ω—Ç–∞`, `–≤–ø–µ—Ä–≤—ã–µ_—É–≤–∏–¥–µ–Ω–æ_–≤_utc`, `telegram_id`, `–∏–º—è_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è`, `–∏–º—è`, `—Ç–µ–ª–µ—Ñ–æ–Ω`, `–ø–æ—Å–ª–µ–¥–Ω—è—è_–∑–∞–ø–∏—Å—å_–≤_utc`, `–≤—Å–µ–≥–æ_–∑–∞–ø–∏—Å–µ–π`, `ban_status`, `ban_reason`, `–Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ_21–¥–µ–Ω—å_utc`.

**–•—Ä–∞–Ω–µ–Ω–∏–µ —É—Å–ª—É–≥:** –£—Å–ª—É–≥–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —Ñ–∞–π–ª–µ `services.json` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞. –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —É—Å–ª—É–≥–∏ –º–∏–≥—Ä–∏—Ä—É—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–º–µ–Ω—é (¬´–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—Å–ª—É–≥–∞–º–∏¬ª).

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç (–∫–æ—Ä–æ—Ç–∫–æ)

- `index.js` –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∫–æ–Ω—Ñ–∏–≥ (`src/config`), Google Sheets —Å–µ—Ä–≤–∏—Å (`src/services/googleSheets.js`), –∑–∞–ø—É—Å–∫–∞–µ—Ç –±–æ—Ç–∞ (`src/bot`) –∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç cron‚Äë–Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è (`src/services/reminders.js`).
- `src/bot` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `telegraf` + `telegraf-session-local` –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–µ—Å—Å–∏–π –≤ `sessions.json` –∏ —Å—Ü–µ–Ω (`WizardScene`) –¥–ª—è –¥–∏–∞–ª–æ–≥–∞ –∑–∞–ø–∏—Å–∏ (`src/bot/scenes/bookingScene.js`).
- `src/services/booking.js` –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –±–∏–∑–Ω–µ—Å‚Äë–ª–æ–≥–∏–∫—É: —É—Å–ª—É–≥–∏, –≥–µ–Ω–µ—Ä–∞—Ü–∏—é —Å–ª–æ—Ç–æ–≤, –ø—Ä–æ–≤–µ—Ä–∫—É –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–π –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ (append –≤ `Appointments`).
- `src/services/googleSheets.js` —Ä–µ–∞–ª–∏–∑—É–µ—Ç –≤—Å–µ —á—Ç–µ–Ω–∏—è/–∑–∞–ø–∏—Å–∏ –≤ Google Sheets –∏ –∏–º–µ–µ—Ç –ø—Ä–æ—Å—Ç–æ–π in‚Äëmemory –∫—ç—à –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —á—Ç–µ–Ω–∏–π –ø–æ –¥–∞—Ç–∞–º.

## –ë–∞–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

- –î–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –∫–ª–∏–µ–Ω—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞–¥–º–∏–Ω‚Äë—Ñ—É–Ω–∫—Ü–∏—é –±–æ—Ç–∞ (–±–∞–Ω –ø–æ Telegram ID –∏–ª–∏ username). –°–∏—Å—Ç–µ–º–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç —Å—Ç–∞—Ç—É—Å –º–µ–∂–¥—É –ª–æ–∫–∞–ª—å–Ω—ã–º —Ñ–∞–π–ª–æ–º `banned.json` –∏ –ª–∏—Å—Ç–æ–º `–ö–ª–∏–µ–Ω—Ç—ã` –≤ Google Sheets.
- –í —Ç–∞–±–ª–∏—Ü–µ `–ö–ª–∏–µ–Ω—Ç—ã` —Å—Ç–∞—Ç—É—Å —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –∫–æ–ª–æ–Ω–∫–∞—Ö `ban_status` (–∑–Ω–∞—á–µ–Ω–∏–µ `banned` –∏–ª–∏ –ø—É—Å—Ç–æ) –∏ `ban_reason` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –ø—Ä–∏—á–∏–Ω–∞).
- –ó–∞–±–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:
  - –Ω–µ –º–æ–≥—É—Ç –Ω–∞—á–∞—Ç—å —Å—Ü–µ–Ω—É –∑–∞–ø–∏—Å–∏ ‚Äî –±–æ—Ç —Å–æ–æ–±—â–∞–µ—Ç –æ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ –∏ –∑–∞–≤–µ—Ä—à–∞–µ—Ç —Å—Ü–µ–Ω—É;
  - –Ω–µ –º–æ–≥—É—Ç —Å–æ–∑–¥–∞—Ç—å –∑–∞–ø–∏—Å—å ‚Äî —Å–µ—Ä–≤–∏—Å –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `{ ok: false, reason: "banned" }`;
  - –Ω–µ –ø–æ–ª—É—á–∞—é—Ç –º–∞—Å—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø—Ä–∏ –≤–∫–ª—é—á—ë–Ω–Ω–æ–º `skipBanned`.

## –ö–æ–º–∞–Ω–¥—ã –∏ UX –±–æ—Ç–∞

- `/start` ‚Äî –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∏ –±–∞–∑–æ–≤–∞—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞.
- `–ó–∞–ø–∏—Å–∞—Ç—å—Å—è üíá‚Äç‚ôÇÔ∏è` –∏–ª–∏ `/book` ‚Äî –∑–∞–ø—É—Å–∫ —Å—Ü–µ–Ω—ã –∑–∞–ø–∏—Å–∏.
- `–ú–æ–∏ –∑–∞–ø–∏—Å–∏` ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –±—É–¥—É—â–∏–µ –∑–∞–ø–∏—Å–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –æ—Ç–º–µ–Ω—ã (inline‚Äë–∫–Ω–æ–ø–∫–∏).
- `/services` ‚Äî –≤—ã–≤–æ–¥–∏—Ç —Å–ø–∏—Å–æ–∫ —É—Å–ª—É–≥ –∏ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

### –ê–¥–º–∏–Ω‚Äë—Ä–µ–∂–∏–º

- –ö–æ–º–∞–Ω–¥—ã: `/admin` ‚Äî –≤–∫–ª—é—á–∏—Ç—å —Ä–µ–∂–∏–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞ —Å `MANAGER_CHAT_ID`), `/user` ‚Äî –≤–µ—Ä–Ω—É—Ç—å—Å—è –≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Ä–µ–∂–∏–º.
- –í –∞–¥–º–∏–Ω‚Äë—Ä–µ–∂–∏–º–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–∞–∫ –æ–±—ã—á–Ω–∞—è reply‚Äë–∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ —Å –ø—É–Ω–∫—Ç–∞–º–∏:
  - `–ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–ø–∏—Å–µ–π`, `–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞`, `–û—Ç–º–µ–Ω–∏—Ç—å –∑–∞–ø–∏—Å—å (–ø–æ ID)`, `–ó–∞–±–∞–Ω–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è`, `–†–∞–∑–±–∞–Ω–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è`, `–ú–∞—Å—Å–æ–≤–∞—è —Ä–∞—Å—Å—ã–ª–∫–∞`, `–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—Å–ª—É–≥–∞–º–∏`, `–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Ä–µ–∂–∏–º`.
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—Å–ª—É–≥–∞–º–∏** ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, —É–¥–∞–ª–µ–Ω–∏–µ –∏ –ø—Ä–æ—Å–º–æ—Ç—Ä —É—Å–ª—É–≥ —Å —Ü–µ–Ω–∞–º–∏ –∏ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é.
- –¢–µ–∫—Å—Ç–æ–≤—ã–µ –≤–≤–æ–¥—ã –∞–¥–º–∏–Ω–∞ (–æ—Ç–º–µ–Ω–∞ –ø–æ ID, –±–∞–Ω/—Ä–∞–∑–±–∞–Ω, —Ç–µ–∫—Å—Ç —Ä–∞—Å—Å—ã–ª–∫–∏) –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ –∞–¥–º–∏–Ω‚Äë—Ä–µ–∂–∏–º–µ (`ctx.session.mode === 'admin'`).
- –ú–∞—Å—Å–æ–≤–∞—è —Ä–∞—Å—Å—ã–ª–∫–∞ –∏–º–µ–µ—Ç –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä: –º–µ–Ω–µ–¥–∂–µ—Ä –ø–æ–ª—É—á–∞–µ—Ç –ø—Ä–∏–º–µ—Ä –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π –∏ –∫–Ω–æ–ø–∫—É `–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å`/`–û—Ç–º–µ–Ω–∏—Ç—å` –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π; —Ä–∞—Å—Å—ã–ª–∫–∞ —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤ –ø–æ –Ω–∞–ª–∏—á–∏—é `telegramId` –∏ –∏—Å–∫–ª—é—á–∞–µ—Ç –∑–∞–±–∞–Ω–µ–Ω–Ω—ã—Ö.

–ü—Ä–æ—Ü–µ—Å—Å –∑–∞–ø–∏—Å–∏: –≤—ã–±–æ—Ä —É—Å–ª—É–≥–∏ ‚Üí –≤—ã–±–æ—Ä –¥–∞—Ç—ã (–∏–Ω–ª–∞–π–Ω‚Äë–∫–Ω–æ–ø–∫–∏) ‚Üí –≤—ã–±–æ—Ä –≤—Ä–µ–º–µ–Ω–∏ (—Å–ª–æ—Ç—ã –ø–æ 15 –º–∏–Ω—É—Ç, —Å —à–∞–≥–æ–º) ‚Üí –≤–≤–æ–¥ –∏–º–µ–Ω–∏ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–Ω—Ç–∞–∫—Ç–∞ ‚Üí –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π ‚Üí –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ.

–ü–æ–≤–µ–¥–µ–Ω–∏–µ –∫–∞–ª–µ–Ω–¥–∞—Ä—è –≤—ã–±–æ—Ä–∞ –¥–∞—Ç—ã:

- –ü–æ–∫–∞–∑–∞–Ω—ã —Ç–æ–ª—å–∫–æ –¥–∞—Ç—ã —Ç–µ–∫—É—â–µ–≥–æ –º–µ—Å—è—Ü–∞. –ü–æ—Å–ª–µ 15-–≥–æ —á–∏—Å–ª–∞ —Ç–µ–∫—É—â–µ–≥–æ –º–µ—Å—è—Ü–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞–ø–∏—Å–∏ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –º–µ—Å—è—Ü.
- –ü—Ä–æ—à–µ–¥—à–∏–µ –¥–Ω–∏ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è (—É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —Ç–∞–π–º–∑–æ–Ω–∞ —Å–∞–ª–æ–Ω–∞).

-## –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –∏ cron

- –í 10:00 (–ø–æ —Ç–∞–π–º–∑–æ–Ω–µ —Å–∞–ª–æ–Ω–∞) –±–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞–º –æ –∑–∞–ø–∏—Å—è—Ö –Ω–∞ –∑–∞–≤—Ç—Ä–∞.
- –ö–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –æ–∫–Ω–æ ¬´~2 —á–∞—Å–∞ –¥–æ –∑–∞–ø–∏—Å–∏¬ª –∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞–º.
- –ö–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≤–µ—Ä—à–∞—é—Ç—Å—è –ø—Ä–æ—à–µ–¥—à–∏–µ –∑–∞–ø–∏—Å–∏: —Å—Ç–∞—Ç—É—Å –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ "–∏—Å–ø–æ–ª–Ω–µ–Ω–æ" —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ —É—Å–ª—É–≥–∏.
- **–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –¥–ª—è –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤**: –µ–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 11:00 –±–æ—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –ø–æ—Å–µ—â–∞–ª–∏ —Å–∞–ª–æ–Ω –±–æ–ª–µ–µ 21 –¥–Ω—è –∏ –Ω–µ –∏–º–µ—é—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π, –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏–º –¥—Ä—É–∂–µ–ª—é–±–Ω–æ–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ —Å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ–º –∑–∞–ø–∏—Å–∞—Ç—å—Å—è. –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑, –æ —á—ë–º —Å–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤—É–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ–µ –ø–æ–ª–µ `–Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ_21–¥–µ–Ω—å_utc` –≤ —Ç–∞–±–ª–∏—Ü–µ –∫–ª–∏–µ–Ω—Ç–æ–≤. –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –Ω–æ–≤–æ–π –∑–∞–ø–∏—Å–∏ —ç—Ç–æ –ø–æ–ª–µ –æ—á–∏—â–∞–µ—Ç—Å—è, —á—Ç–æ–±—ã –∫–ª–∏–µ–Ω—Ç —Å–Ω–æ–≤–∞ –º–æ–≥ –ø–æ–ª—É—á–∏—Ç—å –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ —á–µ—Ä–µ–∑ 21 –¥–µ–Ω—å.

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

–ë–æ—Ç –≤–∫–ª—é—á–∞–µ—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ –º–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞, DDoS-–∞—Ç–∞–∫, –∏–Ω—ä–µ–∫—Ü–∏–π –∏ —É—Ç–µ—á–µ–∫ –¥–∞–Ω–Ω—ã—Ö.

### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞**

   - –í—Å–µ –∞–¥–º–∏–Ω-–∫–æ–º–∞–Ω–¥—ã –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å `MANAGER_CHAT_ID`
   - –§—É–Ω–∫—Ü–∏—è `isAdmin()` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –≤–æ –≤—Å–µ—Ö 26 –∞–¥–º–∏–Ω-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞—Ö
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–µ—Ä–µ–¥ –∫–∞–∂–¥–æ–π –∫—Ä–∏—Ç–∏—á–Ω–æ–π –æ–ø–µ—Ä–∞—Ü–∏–µ–π

2. **Rate Limiting (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —á–∞—Å—Ç–æ—Ç—ã –∑–∞–ø—Ä–æ—Å–æ–≤)**

   - Middleware –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç —á–∞—Å—Ç–æ—Ç—É –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç DDoS –∏ —Å–ø–∞–º–∞
   - –õ–∏–º–∏—Ç—ã: –æ–±—â–∏–µ –∫–æ–º–∞–Ω–¥—ã (30/–º–∏–Ω—É—Ç—É), –∞–¥–º–∏–Ω-–∫–æ–º–∞–Ω–¥—ã (10/–º–∏–Ω—É—Ç—É), —Å—Ü–µ–Ω—ã (5/–º–∏–Ω—É—Ç—É)
   - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞–º—è—Ç–∏: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (>10 –º–∏–Ω—É—Ç), LRU eviction –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ 5000 –∑–∞–ø–∏—Å–µ–π

3. **–í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**

   - –í–∞–ª–∏–¥–∞—Ü–∏—è Telegram ID, ID –∑–∞–ø–∏—Å–µ–π, —Ç–µ–ª–µ—Ñ–æ–Ω–Ω—ã—Ö –Ω–æ–º–µ—Ä–æ–≤
   - –í–∞–ª–∏–¥–∞—Ü–∏—è –∏–º–µ–Ω –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º –¥–ª–∏–Ω—ã
   - LRU –∫—ç—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (100 –∑–∞–ø–∏—Å–µ–π) –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
   - –†–∞–Ω–Ω–∏–π –≤—ã—Ö–æ–¥ –ø—Ä–∏ –ø—Ä–æ—Å—Ç—ã—Ö –ø—Ä–æ–≤–µ—Ä–∫–∞—Ö (–¥–ª–∏–Ω–∞ –ø–µ—Ä–µ–¥ regex)

4. **–ó–∞—â–∏—Ç–∞ –æ—Ç XSS (Cross-Site Scripting)**

   - –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –ø–æ–ª–µ–π (—ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ HTML-—Å–ø–µ—Ü—Å–∏–º–≤–æ–ª–æ–≤)
   - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–ª–∏–Ω—ã –≤–≤–æ–¥–∏–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö
   - –ó–∞—â–∏—Ç–∞ —Ç–µ–∫—Å—Ç–∞ —Ä–∞—Å—Å—ã–ª–æ–∫ –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤

5. **–ó–∞—â–∏—Ç–∞ —Å–µ—Å—Å–∏–π**

   - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ —Å–µ—Å—Å–∏–π (–º–∞–∫—Å–∏–º—É–º 10KB –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
   - –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ DoS —á–µ—Ä–µ–∑ –±–æ–ª—å—à–∏–µ —Å–µ—Å—Å–∏–∏
   - –í–∞–ª–∏–¥–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Å–µ—Å—Å–∏–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ

6. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π**

   - –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∞–¥–º–∏–Ω-–æ–ø–µ—Ä–∞—Ü–∏–π, –±–∞–Ω–æ–≤, –º–∞—Å—Å–æ–≤—ã—Ö —Ä–∞—Å—Å—ã–ª–æ–∫
   - –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –±—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—è (batch writes –∫–∞–∂–¥—ã–µ 2 —Å–µ–∫—É–Ω–¥—ã –∏–ª–∏ –ø—Ä–∏ 50 –∑–∞–ø–∏—Å—è—Ö)
   - –õ–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `logs/security.log` —Å —Ä–æ—Ç–∞—Ü–∏–µ–π –ø–æ —Ä–∞–∑–º–µ—Ä—É (–º–∞–∫—Å–∏–º—É–º 10MB)
   - –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ, –æ—Å—Ç–∞–ª—å–Ω—ã–µ - —á–µ—Ä–µ–∑ –±—É—Ñ–µ—Ä

7. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –º–∞—Å—Å–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π**

   - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π —Ä–∞—Å—Å—ã–ª–∫–∏: 1000
   - –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è –≤—Å–µ—Ö —Ä–∞—Å—Å—ã–ª–æ–∫
   - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –º–∞—Å—Å–æ–≤—ã—Ö —Ä–∞—Å—Å—ã–ª–æ–∫ —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π

8. **–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ**

   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (`sessions.json`, `banned.json`, `services.json`)
   - –ë—ç–∫–∞–ø—ã –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é (—Ä–∞–∑ –≤ –¥–µ–Ω—å) –∏ –ø—Ä–∏ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö (–±–∞–Ω, –º–∞—Å—Å–æ–≤–∞—è —Ä–∞—Å—Å—ã–ª–∫–∞)
   - –î–µ–±–∞—É–Ω—Å–∏–Ω–≥: –µ—Å–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –ø–æ–¥—Ä—è–¥, –¥–µ–ª–∞–µ—Ç—Å—è –æ–¥–∏–Ω –±—ç–∫–∞–ø —á–µ—Ä–µ–∑ 30 —Å–µ–∫—É–Ω–¥
   - –•—Ä–∞–Ω–µ–Ω–∏–µ –±—ç–∫–∞–ø–æ–≤ –≤ `backups/` —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—á–∏—Å—Ç–∫–æ–π —Å—Ç–∞—Ä—ã—Ö (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π)

9. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π**
   - –°–∫—Ä–∏–ø—Ç—ã –¥–ª—è –∞—É–¥–∏—Ç–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏: `npm run audit`, `npm run audit:fix`, `npm run security-check`
   - –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Ä–µ–≥—É–ª—è—Ä–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å `npm run security-check` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π

### –§–∞–π–ª—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

- `src/utils/security.js` - —É—Ç–∏–ª–∏—Ç—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏ —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏–∏
- `src/middleware/rateLimiter.js` - rate limiting middleware
- `src/utils/logger.js` - —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- `src/utils/backup.js` - —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ó–∞–º–µ—Ç–∫–∏ –ø–æ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—é

- –ù–µ –∫–æ–º–º–∏—Ç–∏—Ç–µ `.env`, `credentials.json`, `sessions.json`, `banned.json` –∏–ª–∏ `logs/` –≤ –ø—É–±–ª–∏—á–Ω—ã–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
- –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ process manager (pm2, systemd) –∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª–æ–≥–æ–≤
- –†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ª–æ–≥–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤ `logs/security.log`
- –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞–π—Ç–µ `npm run security-check` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- –ë—ç–∫–∞–ø—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ `backups/` - —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –∑–∞—â–∏—â–µ–Ω–∞ –æ—Ç –ø—É–±–ª–∏—á–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞

## –ì–¥–µ —Å–º–æ—Ç—Ä–µ—Ç—å –∫–æ–¥

- –í—Ö–æ–¥–Ω–∞—è —Ç–æ—á–∫–∞: [index.js](index.js)
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è: [src/config/index.js](src/config/index.js)
- –ë–æ—Ç –∏ —Å—Ü–µ–Ω—ã: [src/bot/index.js](src/bot/index.js), [src/bot/scenes/bookingScene.js](src/bot/scenes/bookingScene.js)
- –°–µ—Ä–≤–∏—Å—ã: [src/services/googleSheets.js](src/services/googleSheets.js), [src/services/booking.js](src/services/booking.js), [src/services/services.js](src/services/services.js), [src/services/reminders.js](src/services/reminders.js), [src/services/admin.js](src/services/admin.js)
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: [src/utils/security.js](src/utils/security.js), [src/middleware/rateLimiter.js](src/middleware/rateLimiter.js), [src/utils/logger.js](src/utils/logger.js), [src/utils/backup.js](src/utils/backup.js)
